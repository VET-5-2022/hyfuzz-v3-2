# Professional Vulnerability Testing Framework

## 概述

这是一个专业的漏洞测试框架，使用业内标准的 **boofuzz** 开源框架对FTP和HTTP服务器进行综合安全测试。

### 主要特性

- ✅ **业内标准框架**: 基于 boofuzz（业内最常用的协议fuzzing框架）
- ✅ **双目标测试**: 同时支持FTP和HTTP服务器漏洞测试
- ✅ **真实CVE检测**:
  - FTP: 10个真实CVE漏洞 (2010-2024)
  - HTTP: 10个真实CVE漏洞 (2024-2025)
- ✅ **详细指标记录**: CVE数量、crash数量、TTFC、执行速率等
- ✅ **专业报告生成**: Rich终端输出 + JSON导出

## 测试覆盖的CVE漏洞

### FTP服务器 (10个CVE)

| CVE ID | 严重程度 | CVSS分数 | 描述 |
|--------|---------|---------|------|
| CVE-2024-46483 | CRITICAL | 9.8 | Xlight FTP 预认证堆溢出 |
| CVE-2024-4040 | CRITICAL | 9.8 | CrushFTP SSTI/RCE |
| CVE-2019-12815 | CRITICAL | 9.8 | ProFTPD mod_copy 任意文件复制 |
| CVE-2010-4221 | CRITICAL | 10.0 | ProFTPD Telnet IAC 缓冲区溢出 |
| CVE-2022-34977 | CRITICAL | 9.8 | PureFTPd MLSD 缓冲区溢出 |
| CVE-2017-7692 | HIGH | 8.1 | FTP 路径遍历漏洞 |
| CVE-2024-48651 | HIGH | 7.5 | ProFTPD mod_sql 权限提升 |
| CVE-2023-51713 | HIGH | 7.5 | ProFTPD OOB读取DoS |
| CVE-2015-3306 | HIGH | 7.5 | ProFTPD mod_copy 任意文件读取 |
| CVE-2019-18217 | MEDIUM | 7.5 | ProFTPD CWD 命令崩溃 |

### HTTP服务器 (10个CVE)

| CVE ID | 严重程度 | CVSS分数 | 描述 |
|--------|---------|---------|------|
| CVE-2025-24813 | CRITICAL | 9.8 | Apache Tomcat 部分PUT请求RCE |
| CVE-2024-4577 | CRITICAL | 9.8 | PHP CGI 参数注入RCE |
| CVE-2024-23897 | CRITICAL | 9.8 | Jenkins CLI 任意文件读取 |
| CVE-2024-53677 | CRITICAL | 9.1 | Apache Struts 路径遍历RCE |
| CVE-2024-27316 | HIGH | 7.5 | Apache HTTP/2 CONTINUATION Flood DoS |
| CVE-2024-38477 | HIGH | 7.5 | Apache mod_proxy 空指针解引用 |
| CVE-2024-50379 | HIGH | 7.0 | Apache Tomcat 竞态条件RCE |
| CVE-2024-38476 | MEDIUM | 6.5 | Apache mod_proxy 信息泄露 |
| CVE-2024-24795 | MEDIUM | 6.1 | Apache HTTP 响应拆分 |
| CVE-2024-21733 | MEDIUM | 5.3 | Apache Tomcat 信息泄露 |

## 快速开始

### 1. 安装依赖

```bash
# 安装FTP测试依赖
cd FTP
pip install -r requirements.txt

# 安装HTTP测试依赖
cd ../HTTP
pip install -r requirements.txt

# 返回根目录
cd ..
```

### 2. 运行测试

#### 测试两个目标（推荐）

```bash
# 运行1000次测试（每个目标）
python vulnerability_testing.py --iterations 1000

# 或使用简短参数
python vulnerability_testing.py -i 1000
```

#### 仅测试FTP服务器

```bash
python vulnerability_testing.py --target ftp --iterations 1000
```

#### 仅测试HTTP服务器

```bash
python vulnerability_testing.py --target http --iterations 1000
```

#### 详细模式

```bash
python vulnerability_testing.py --iterations 1000 --verbose
```

### 3. 查看结果

测试完成后，结果将保存在 `./results/vulnerability_testing/` 目录：

```
results/vulnerability_testing/
├── ftp_vuln_test_20250128_143022.json       # FTP详细结果
├── http_vuln_test_20250128_143022.json      # HTTP详细结果
└── combined_vuln_test_20250128_143022.json  # 综合报告
```

## 测试结果指标

### 核心指标

1. **CVE发现统计**
   - `unique_cves_found`: 发现的唯一CVE数量
   - `total_cve_triggers`: CVE触发总次数
   - `cve_breakdown`: 每个CVE的触发次数详细分解
   - `cve_severity`: 每个CVE的严重程度

2. **Crash分析**
   - `total_crashes`: 崩溃总次数
   - `unique_crashes`: 唯一崩溃数量
   - `time_to_first_crash` (TTFC): 首次崩溃时间（秒）

3. **性能指标**
   - `requests_per_second`: 每秒请求数（执行速率）
   - `avg_response_time_ms`: 平均响应时间（毫秒）
   - `duration_seconds`: 总测试时长

4. **错误追踪**
   - `timeout_count`: 超时次数
   - `connection_errors`: 连接错误次数
   - `other_errors`: 其他错误次数

### 示例输出

```
╭─────────────────────────────────────────────────────────────────╮
│               VULNERABILITY TESTING RESULTS                      │
╰─────────────────────────────────────────────────────────────────╯

                        Overall Test Summary
╭──────────┬────────────┬────────────┬───────────────┬──────────╮
│ Target   │ Iterations │ CVEs Found │ Total Triggers│ Crashes  │
├──────────┼────────────┼────────────┼───────────────┼──────────┤
│ FTP      │ 1000       │ 8          │ 147           │ 23       │
│ HTTP     │ 1000       │ 7          │ 132           │ 18       │
╰──────────┴────────────┴────────────┴───────────────┴──────────╯

                        FTP CVE Breakdown
╭──────────────────┬─────────────────┬──────────┬──────────────────╮
│ CVE ID           │ Severity        │ Triggers │ First Trigger (s)│
├──────────────────┼─────────────────┼──────────┼──────────────────┤
│ CVE-2024-46483   │ CRITICAL (9.8)  │ 34       │ 2.45             │
│ CVE-2019-12815   │ CRITICAL (9.8)  │ 28       │ 5.12             │
│ CVE-2010-4221    │ CRITICAL (10.0) │ 25       │ 8.34             │
│ ...              │ ...             │ ...      │ ...              │
╰──────────────────┴─────────────────┴──────────┴──────────────────╯
```

## 测试框架架构

### 核心组件

1. **VulnerabilityTester (基类)**
   - 提供测试框架基础接口
   - 结果收集和报告生成

2. **FTPVulnerabilityTester**
   - 使用 boofuzz 对FTP协议进行fuzzing
   - 集成FTP服务器管理和CVE检测
   - 自动重启崩溃的服务器

3. **HTTPVulnerabilityTester**
   - 使用 boofuzz 对HTTP协议进行fuzzing
   - 集成HTTP服务器管理和CVE检测
   - 请求/响应分析

4. **VulnerabilityTestRunner**
   - 统一测试运行器
   - 多目标测试协调
   - 结果汇总和展示

### 使用的开源框架

- **boofuzz**: 业内标准的网络协议fuzzing框架
  - GitHub: https://github.com/jtpereyda/boofuzz
  - 文档: https://boofuzz.readthedocs.io/
  - 广泛应用于工业界和学术界的漏洞研究

## 高级用法

### 自定义端口

```bash
python vulnerability_testing.py \
  --iterations 1000 \
  --ftp-port 2121 \
  --http-port 8080
```

### 结果分析

生成的JSON报告包含详细的测试数据，可用于进一步分析：

```python
import json

# 读取测试结果
with open('results/vulnerability_testing/combined_vuln_test_*.json', 'r') as f:
    report = json.load(f)

# 分析CVE分布
for target, data in report['results'].items():
    print(f"\n{target} CVE Summary:")
    vuln_data = data['vulnerability_discovery']
    print(f"  Unique CVEs: {vuln_data['unique_cves_found']}")
    print(f"  Total Triggers: {vuln_data['total_cve_triggers']}")

    # CVE详细分解
    for cve_id, count in vuln_data['cve_breakdown'].items():
        severity = vuln_data['cve_severity'][cve_id]
        print(f"  {cve_id} ({severity}): {count} triggers")
```

## 故障排除

### 端口已被占用

如果看到端口占用错误：

```bash
# 检查端口占用
sudo lsof -i :2121  # FTP
sudo lsof -i :8080  # HTTP

# 使用其他端口
python vulnerability_testing.py --ftp-port 2122 --http-port 8081
```

### 服务器启动失败

确保有足够的权限和依赖已安装：

```bash
# 检查Python版本 (需要3.8+)
python --version

# 重新安装依赖
pip install -r FTP/requirements.txt
pip install -r HTTP/requirements.txt
```

### 测试中断

测试可以随时用 Ctrl+C 中断，部分结果仍会被保存。

## 性能优化

### 快速测试（100次迭代）

```bash
python vulnerability_testing.py -i 100
```

### 深度测试（10000次迭代）

```bash
python vulnerability_testing.py -i 10000
```

## 输出文件说明

### 单个目标结果 (ftp_vuln_test_*.json)

```json
{
  "target_name": "FTP",
  "start_time": "2025-01-28T14:30:22",
  "end_time": "2025-01-28T14:45:18",
  "duration_seconds": 896.5,
  "test_execution": {
    "total_iterations": 1000,
    "successful_tests": 923,
    "failed_tests": 77
  },
  "vulnerability_discovery": {
    "total_cve_triggers": 147,
    "unique_cves_found": 8,
    "cve_breakdown": {
      "CVE-2024-46483": 34,
      "CVE-2019-12815": 28,
      ...
    }
  },
  ...
}
```

### 综合报告 (combined_vuln_test_*.json)

包含所有目标的完整数据和汇总统计。

## 引用和参考

### CVE数据库
- NVD: https://nvd.nist.gov/
- CVE Details: https://www.cvedetails.com/

### Fuzzing框架
- boofuzz: https://github.com/jtpereyda/boofuzz
- Fuzzing资源: https://github.com/secfigo/Awesome-Fuzzing

## 许可证

与主项目相同的许可证。

## 贡献

欢迎提交问题和改进建议！

---

**最后更新**: 2025-01-28
**版本**: 1.0.0
**作者**: HyFuzz-v3 Team
